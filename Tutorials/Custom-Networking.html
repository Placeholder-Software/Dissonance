
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://placeholder-software.co.uk/dissonance/docs/Tutorials/Custom-Networking.html">
      
      
        <link rel="prev" href="Spatializer-Plugin.html">
      
      
        <link rel="next" href="Custom-Position-Tracking.html">
      
      
      <link rel="icon" href="../dissonance.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>Writing A Custom Network Integration - Dissonance Voice Chat</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/pygment_tweaks.css">
    
      <link rel="stylesheet" href="../css/header_tweaks.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="light-blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#getting-started" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="Dissonance Voice Chat" class="md-header__button md-logo" aria-label="Dissonance Voice Chat" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Dissonance Voice Chat
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Writing A Custom Network Integration
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Placeholder-Software/Dissonance" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    Issue Tracker
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="Dissonance Voice Chat" class="md-nav__button md-logo" aria-label="Dissonance Voice Chat" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Dissonance Voice Chat
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Placeholder-Software/Dissonance" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    Issue Tracker
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Project Setup
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Project Setup
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Basics/Getting-Started.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Basics/Choosing-A-Network.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Choosing A Network
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Installation Requirements
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Installation Requirements
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Basics/Licensing.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Licensing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Platforms/Windows%20Desktop.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Windows (Desktop)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Platforms/Windows%20UWP%20%26%20Hololens.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Windows (UWP/Hololens)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Platforms/Linux.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Linux
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Platforms/MacOS.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MacOS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Platforms/Android.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Android (Including Oculus Quest)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Platforms/iOS.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    iOS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Platforms/Magic%20Leap.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Magic Leap
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Platforms/Oculus%20OVR.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Oculus OVR
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Basics/Other-Integrations.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Other Integrations
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Quick Start Guides
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Quick Start Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Basics/Quick-Start-Mirror.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mirror Networking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Basics/Quick-Start-Unity-NFGO.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Unity Netcode For GameObjects
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Basics/Quick-Start-Forge-Remastered.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Forge Networking Remastered
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Basics/Quick-Start-DR2.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dark Rift 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Basics/Quick-Start-Photon.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Photon Unity Networking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Basics/Quick-Start-Fusion.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Photon Fusion
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Basics/Quick-Start-TNet3.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TNet3
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Basics/Quick-Start-UNet-HLAPI.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Unity Networking HLAPI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Basics/Quick-Start-PureP2P.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    WebRTC Network (self contained)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Basics/Introduction-To-Chat-Rooms.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Basic Concepts
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Introductory Tutorials
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Introductory Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Push-to-Talk.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Push-To-Talk
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Global-Chat-Room.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Global Chat Room
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Team-Chat-Rooms.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Team Chat Rooms
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Text-Chat.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Text Chat
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Direct-Player-Transmit.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Transmit to Player
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Position-Tracking.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Position Tracking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Position-Tracking-For-Bolt.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Position Tracking For BOLT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Proximity-Chat.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Proximity Chat
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Collider-Chat-Room.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Collider Chat Rooms
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Player-State.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Finding Players
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Audio-Mixing.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Audio Mixing For Voice
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Access-Control-Tokens.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Access Tokens
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Channel-Priority.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Channel Priority
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Channel-Volume.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Channel Volume
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Playback-Prefab.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Custom AudioSource Settings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Script-Controlled-Speech.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Script Controlled Speech
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Spatializer-Plugin.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Spatialization Plugins
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Advanced Tutorials
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Advanced Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Writing A Custom Network Integration
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="Custom-Networking.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Writing A Custom Network Integration
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    <span class="md-ellipsis">
      Getting Started
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#customcommsnetwork-basecommsnetwork" class="md-nav__link">
    <span class="md-ellipsis">
      CustomCommsNetwork : BaseCommsNetwork
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#customclient-baseclient" class="md-nav__link">
    <span class="md-ellipsis">
      CustomClient : BaseClient
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CustomClient : BaseClient">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#public-override-void-connect" class="md-nav__link">
    <span class="md-ellipsis">
      public override void Connect()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#protected-override-void-readmessages" class="md-nav__link">
    <span class="md-ellipsis">
      protected override void ReadMessages()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#protected-override-void-sendreliablearraysegment-packet" class="md-nav__link">
    <span class="md-ellipsis">
      protected override void SendReliable(ArraySegment packet)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#protected-override-void-sendunreliablearraysegment-packet" class="md-nav__link">
    <span class="md-ellipsis">
      protected override void SendUnreliable(ArraySegment packet)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#customserver-baseserver" class="md-nav__link">
    <span class="md-ellipsis">
      CustomServer : BaseServer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CustomServer : BaseServer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#public-override-void-connect_1" class="md-nav__link">
    <span class="md-ellipsis">
      public override void Connect()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#public-override-void-disconnect" class="md-nav__link">
    <span class="md-ellipsis">
      public override void Disconnect()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#protected-override-void-readmessages_1" class="md-nav__link">
    <span class="md-ellipsis">
      protected override void ReadMessages()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#protected-override-void-sendreliablecustompeer-destination-arraysegmentbyte-packet" class="md-nav__link">
    <span class="md-ellipsis">
      protected override void SendReliable(CustomPeer destination, ArraySegment&lt;byte&gt; packet)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#protected-override-void-sendunreliablecustompeer-destination-arraysegmentbyte-packet" class="md-nav__link">
    <span class="md-ellipsis">
      protected override void SendUnreliable(CustomPeer destination, ArraySegment&lt;byte&gt; packet)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clientdisconnected" class="md-nav__link">
    <span class="md-ellipsis">
      ClientDisconnected
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#editor-inspector" class="md-nav__link">
    <span class="md-ellipsis">
      Editor Inspector
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing" class="md-nav__link">
    <span class="md-ellipsis">
      Testing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extensions-loopback" class="md-nav__link">
    <span class="md-ellipsis">
      Extensions: Loopback
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extensions-peer-to-peer" class="md-nav__link">
    <span class="md-ellipsis">
      Extensions: Peer To Peer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Extensions: Peer To Peer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#implementing-p2p" class="md-nav__link">
    <span class="md-ellipsis">
      Implementing P2P
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Implementing P2P">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sendreliablep2plistclientinfotpeer-destinations-arraysegmentbyte-packet" class="md-nav__link">
    <span class="md-ellipsis">
      SendReliableP2P(List&lt;ClientInfo&lt;TPeer?&gt;&gt; destinations, ArraySegment&lt;byte&gt; packet)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sendunreliablep2plistclientinfotpeer-destinations-arraysegmentbyte-packet" class="md-nav__link">
    <span class="md-ellipsis">
      SendUnreliableP2P(List&lt;ClientInfo&lt;TPeer?&gt;&gt; destinations, ArraySegment&lt;byte&gt; packet)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Custom-Position-Tracking.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Writing A Custom IDissonancePlayer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Custom-Microphone-Capture.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Writing A Custom Microphone Capture System
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="UsingIMicrophoneSubscriber.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Direct Access To Recorded Audio
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Directly-Using-Channels.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using Channels
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Acoustic-Echo-Cancellation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Acoustic Echo Cancellation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Server-Admin-API.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Server Scripting API
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1" >
        
          
          <label class="md-nav__link" for="__nav_7_1" id="__nav_7_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Components
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_1">
            <span class="md-nav__icon md-icon"></span>
            Components
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Reference/Components/Voice-Broadcast-Trigger.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Voice Broadcast Trigger
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Reference/Components/Voice-Receipt-Trigger.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Voice Receipt Trigger
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Reference/Components/Voice-Proximity-Broadcast-Trigger.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Voice Proximity Broadcast Trigger
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Reference/Components/Voice-Proximity-Receipt-Trigger.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Voice Proximity Receipt Trigger
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Reference/Components/Dissonance-Comms.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dissonance Comms
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2" >
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Audio
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            Audio
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Reference/Audio/VoiceSettings.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Voice Settings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Reference/Audio/IMicrophoneCapture.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    IMicrophoneCapture
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Reference/Audio/IMicrophoneSubscriber.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    IMicrophoneSubscriber
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Reference/Audio/BaseMicrophoneSubscriber.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    BaseMicrophoneSubscriber
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_3" >
        
          
          <label class="md-nav__link" for="__nav_7_3" id="__nav_7_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Networking
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_3">
            <span class="md-nav__icon md-icon"></span>
            Networking
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Reference/Networking/Network-Protocol.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Network Protocol
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Reference/Networking/IServerClientState.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    IServerClientState
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_4" >
        
          
          <label class="md-nav__link" for="__nav_7_4" id="__nav_7_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Other
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_4">
            <span class="md-nav__icon md-icon"></span>
            Other
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Reference/Other/VoiceSettings.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Voice Settings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Reference/Other/Rooms.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Rooms
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Reference/Other/RoomChannels.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RoomChannels
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Reference/Other/RoomChannel.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RoomChannel
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Reference/Other/PlayerChannels.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PlayerChannels
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Reference/Other/PlayerChannel.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PlayerChannel
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Reference/Other/TextChat.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TextChat
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Reference/Other/VoicePlayerState.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    VoicePlayerState
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Reference/Other/RemoteChannel.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RemoteChannel
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Writing A Custom Network Integration</h1>

<p>Dissonance is built to be completely decoupled from the underlying networking system, this allows Dissonance to run on top of various different Unity networking assets (e.g. UNet, Forge, Photon etc) just by swapping which Dissonance network component is used. If none of the <a href="../Basics/Choosing-A-Network.html">existing integrations</a> work for your application then you may need to build a custom network integration.</p>
<h3 id="getting-started">Getting Started<a class="headerlink" href="#getting-started" title="Permanent link">⚓︎</a></h3>
<p>Dissonance includes a set of base classes which implement most of the networking logic for you:</p>
<ul>
<li><code>BaseCommsNetwork</code> - This is the main comms network component which you place into your scene. It manages the networking, starting and stopping Dissonance networking in response to network events.</li>
<li><code>BaseServer</code> - This is a class created by the comms network component on one of the peers in the session. It manages the session as other peers join and leave. You will extend this class to implement your server logic.</li>
<li><code>BaseClient</code> - This is a class created by the comms network component on all the peers in the session. It manages sending and receiving voice. You will extend this class to implement your client logic.</li>
</ul>
<p>Create the <code>CustomCommsNetwork</code> class which extends <code>BaseCommsNetwork</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">CustomCommsNetwork</span>
<span class="w">  </span><span class="p">:</span><span class="w"> </span><span class="n">BaseCommsNetwork</span><span class="o">&lt;</span>
<span class="w">      </span><span class="n">CustomServer</span><span class="p">,</span><span class="w">      </span><span class="c1">// A class which implements BaseServer</span>
<span class="w">      </span><span class="n">CustomClient</span><span class="p">,</span><span class="w">      </span><span class="c1">// A class which implements BaseClient</span>
<span class="w">      </span><span class="n">CustomPeer</span><span class="p">,</span><span class="w">        </span><span class="c1">// A struct which represents a network connection</span>
<span class="w">      </span><span class="n">Unit</span><span class="p">,</span><span class="w">              </span><span class="c1">// Nothing</span>
<span class="w">      </span><span class="n">Unit</span><span class="w">               </span><span class="c1">// Nothing</span>
<span class="w">  </span><span class="o">&gt;</span>
<span class="p">{</span>
<span class="p">}</span>
</code></pre></div>
<p>As you can see <code>BaseCommsNetwork</code> requires 5 type parameters, which specify all the parts of your custom network integration:</p>
<ul>
<li><code>CustomServer</code> - This is a class you will create which extends <code>BaseServer</code></li>
<li><code>CustomClient</code> - This is a class you will create which extends <code>BaseClient</code></li>
<li><code>CustomPeer</code> - This is a struct you will create which represents another peer in the network session.</li>
<li><code>CustomClientParam</code> - This is a struct you will create which contains the data necessary create a network connection (e.g. an IP address). If your network does not need this (e.g. it is already running before Dissonance is started) then just pass <code>Unit</code>.</li>
<li><code>CustomServerParam</code> - This is a struct you will create which contains the data necessary host a network session (e.g. a port number). If your network does not need this (e.g. it is already running before Dissonance is started) then just pass <code>Unit</code>.</li>
</ul>
<p>To create all these types define two new classes:</p>
<ul>
<li><code>class CustomCommsNetwork : BaseCommsNetwork {}</code></li>
<li><code>class CustomClient : BaseClient {}</code></li>
<li><code>class CustomServer : BaseServer {}</code></li>
</ul>
<p>And three new structs:</p>
<ul>
<li><code>struct CustomPeer : IEquatable&lt;CustomPeer&gt; {}</code></li>
<li><code>struct CustomServerParam {}</code></li>
<li><code>struct CustomClientParam {}</code></li>
</ul>
<p>Once you have done this you will have a large number of build errors like "abstract member [...] not implemented" - these are the things you must implement before the network integration can work.</p>
<h2 id="customcommsnetwork-basecommsnetwork"><code>CustomCommsNetwork : BaseCommsNetwork</code><a class="headerlink" href="#customcommsnetwork-basecommsnetwork" title="Permanent link">⚓︎</a></h2>
<p>In your custom comms network class you will need to create your custom client and custom server objects. Dissonance will call these methods when a server or client needs to be created. You shouldn't connect to the network in this method, simply create the objects.</p>
<div class="highlight"><pre><span></span><code><span class="k">protected</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="n">CustomServer</span><span class="w"> </span><span class="nf">CreateServer</span><span class="p">(</span><span class="n">CustomServerParam</span><span class="w"> </span><span class="n">details</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">CustomServer</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="n">details</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">protected</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="n">CustomClient</span><span class="w"> </span><span class="nf">CreateClient</span><span class="p">(</span><span class="n">CustomClientParam</span><span class="w"> </span><span class="n">details</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="nf">CustomClient</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="n">details</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>If you need to do any other setup work for your network system you can override the <code>Initialize</code> method.</p>
<div class="highlight"><pre><span></span><code><span class="k">protected</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">Initialize</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">Network</span><span class="p">.</span><span class="n">DoSomethingImportant</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// Don&#39;t forget to call base.Initialize!</span>
<span class="w">    </span><span class="k">base</span><span class="p">.</span><span class="n">Initialize</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>
<p>Finally you need to start the network and tell it to connect, there are two main techniques for this. Some integrations (e.g. Mirror/Photon) have a network system which is already connected and Dissonance can use that, other integrations (e.g. WebRTC) host a network session specifically for voice chat.</p>
<p>If you are using the first technique then you need to monitor the external network system and make sure that Dissonance is running in the same way as the network system by calling <code>RunAsHost</code>, <code>RunAsDedicatedServer</code>, <code>RunAsClient</code> or <code>Stop</code>. Here is how this is implemented in the HLAPI network integration:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Check every frame</span>
<span class="k">protected</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">Update</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="c1">// Check if Dissonance is ready</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IsInitialized</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Check if the HLAPI is ready</span>
<span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">networkActive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NetworkManager</span><span class="p">.</span><span class="n">singleton</span><span class="p">.</span><span class="n">isNetworkActive</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">NetworkServer</span><span class="p">.</span><span class="n">active</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">NetworkClient</span><span class="p">.</span><span class="n">active</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">networkActive</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Check what mode the HLAPI is in</span>
<span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NetworkServer</span><span class="p">.</span><span class="n">active</span><span class="p">;</span>
<span class="w">            </span><span class="kt">var</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NetworkClient</span><span class="p">.</span><span class="n">active</span><span class="p">;</span>

<span class="w">            </span><span class="c1">// Check what mode Dissonance is in and if</span>
<span class="w">            </span><span class="c1">// they&#39;re different then call the correct method</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Mode</span><span class="p">.</span><span class="n">IsServerEnabled</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">Mode</span><span class="p">.</span><span class="n">IsClientEnabled</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">client</span><span class="p">)</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">                </span><span class="c1">// HLAPI is server and client, so run as a non-dedicated</span>
<span class="w">                </span><span class="c1">// host (passing in the correct parameters)</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">server</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">client</span><span class="p">)</span>
<span class="w">                    </span><span class="n">RunAsHost</span><span class="p">(</span><span class="n">Unit</span><span class="p">.</span><span class="n">None</span><span class="p">,</span><span class="w"> </span><span class="n">Unit</span><span class="p">.</span><span class="n">None</span><span class="p">);</span>

<span class="w">                </span><span class="c1">// HLAPI is just a server, so run as a dedicated host</span>
<span class="w">                </span><span class="k">else</span><span class="w"> </span><span class="nf">if</span><span class="w"> </span><span class="p">(</span><span class="n">server</span><span class="p">)</span>
<span class="w">                    </span><span class="n">RunAsDedicatedServer</span><span class="p">(</span><span class="n">Unit</span><span class="p">.</span><span class="n">None</span><span class="p">);</span>

<span class="w">                </span><span class="c1">// HLAPI is just a client, so run as a client</span>
<span class="w">                </span><span class="k">else</span><span class="w"> </span><span class="nf">if</span><span class="w"> </span><span class="p">(</span><span class="n">client</span><span class="p">)</span>
<span class="w">                    </span><span class="n">RunAsClient</span><span class="p">(</span><span class="n">Unit</span><span class="p">.</span><span class="n">None</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="nf">if</span><span class="w"> </span><span class="p">(</span><span class="n">Mode</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">NetworkMode</span><span class="p">.</span><span class="n">None</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="c1">//Network is not active, make sure Dissonance is not active</span>
<span class="w">            </span><span class="n">Stop</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">base</span><span class="p">.</span><span class="n">Update</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>
<p>If you are using the second technique then you will need to decide when to call <code>RunAsHost</code>, <code>RunAsDedicatedServer</code>, <code>RunAsClient</code> or <code>Stop</code> at the appropriate times.</p>
<h2 id="customclient-baseclient"><code>CustomClient : BaseClient</code><a class="headerlink" href="#customclient-baseclient" title="Permanent link">⚓︎</a></h2>
<p>This class handles all of the client side logic of Dissonance, one of these will be created on every single peer in the session (including the host). There will be two build errors to fix in this class.</p>
<p><code>Base class [...] doesn't contain a parameterless constructor</code>. To fix this simply add a constructor which passes a <code>CustomCommsNetwork</code> to the base class:</p>
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="nf">CustomClient</span><span class="p">(</span><span class="n">CustomCommsNetwork</span><span class="w"> </span><span class="n">network</span><span class="p">,</span><span class="w"> </span><span class="n">CustomClientParam</span><span class="w"> </span><span class="n">details</span><span class="p">)</span>
<span class="w">    </span><span class="p">:</span><span class="w"> </span><span class="k">base</span><span class="p">(</span><span class="n">network</span><span class="p">)</span>
<span class="p">{</span>
<span class="p">}</span>
</code></pre></div>
<p><code>abstract member [...] not implemented</code>. There will be four of these errors to fix:</p>
<h4 id="public-override-void-connect">public override void Connect()<a class="headerlink" href="#public-override-void-connect" title="Permanent link">⚓︎</a></h4>
<p>This will be called when you need to connect to the session. You should start connecting to the network when this is called, once you have finished connecting (which may take a long time) you must call <code>base.Connected()</code>. In systems where there is already a network connection setup you may just immediately call <code>base.Connected()</code>.</p>
<h4 id="protected-override-void-readmessages">protected override void ReadMessages()<a class="headerlink" href="#protected-override-void-readmessages" title="Permanent link">⚓︎</a></h4>
<p>This will be called periodically to poll messages from the network system. Any packets you receive must be passed to <code>base.NetworkPacketReceived</code>.</p>
<h4 id="protected-override-void-sendreliablearraysegment-packet">protected override void SendReliable(ArraySegment<byte> packet)<a class="headerlink" href="#protected-override-void-sendreliablearraysegment-packet" title="Permanent link">⚓︎</a></h4>
<p>This method sends a packet to the server using a <strong>reliable</strong> and <strong>in order</strong> channel (e.g. TCP). Packets sent with this method are not latency sensitive but MUST arrive in order. If you detect that a reliable packet has been lost you should immediately stop the Dissonance network session.</p>
<h4 id="protected-override-void-sendunreliablearraysegment-packet">protected override void SendUnreliable(ArraySegment<byte> packet)<a class="headerlink" href="#protected-override-void-sendunreliablearraysegment-packet" title="Permanent link">⚓︎</a></h4>
<p>This methods sends a packet to the server using an <strong>unreliable</strong> and <strong>unordered</strong> channel (e.g. UDP). Packets sent with this method are <em>extremely</em> latency sensitive and must arrive as soon as possible or not at all. It is expected that some packets sent using this method may be lost or arrive out of order.</p>
<h2 id="customserver-baseserver"><code>CustomServer : BaseServer</code><a class="headerlink" href="#customserver-baseserver" title="Permanent link">⚓︎</a></h2>
<p>This class handles all the server side logic of Dissonance, one of these will be created on a single peer in the session and handles managing the session. In the basic configuration all voice data is relayed via this peer (see P2P section for details on how to avoid this). There will be five "abstract member [...] not implemented" errors to fix:</p>
<h4 id="public-override-void-connect_1"><code>public override void Connect()</code><a class="headerlink" href="#public-override-void-connect_1" title="Permanent link">⚓︎</a></h4>
<p>This will be called when you need to host a new network session (e.g. open a socket).</p>
<h4 id="public-override-void-disconnect"><code>public override void Disconnect()</code><a class="headerlink" href="#public-override-void-disconnect" title="Permanent link">⚓︎</a></h4>
<p>This will be called when you need to stop hosting a session (e.g. close the socket).</p>
<h4 id="protected-override-void-readmessages_1"><code>protected override void ReadMessages()</code><a class="headerlink" href="#protected-override-void-readmessages_1" title="Permanent link">⚓︎</a></h4>
<p>This will be called periodically to poll messages from the network system. Any packets you receive should be to <code>base.NetworkPacketReceived</code>. The <code>base.NetworkPacketReceived</code> method on the server requires an instance of your <code>CustomPeer</code> type which indicates who sent the message.</p>
<h4 id="protected-override-void-sendreliablecustompeer-destination-arraysegmentbyte-packet"><code>protected override void SendReliable(CustomPeer destination, ArraySegment&lt;byte&gt; packet)</code><a class="headerlink" href="#protected-override-void-sendreliablecustompeer-destination-arraysegmentbyte-packet" title="Permanent link">⚓︎</a></h4>
<p>This method sends a reliable packet to another peer using a <strong>reliable</strong> and <strong>in order</strong> channel (e.g. TCP). Packets sent with this method are not latency sensitive but MUST arrive in order. If you detect that a reliable packet has been lost you should immediately stop the Dissonance network session.</p>
<p>If you need some extra information about who the packet is being sent to, you should add it to the <code>CustomPeer</code> struct. Remember to go to the <code>ReadMessages</code> method and add that information to the <code>CustomPeer</code> struct you passed in to <code>NetworkPacketReceived</code>.</p>
<h4 id="protected-override-void-sendunreliablecustompeer-destination-arraysegmentbyte-packet"><code>protected override void SendUnreliable(CustomPeer destination, ArraySegment&lt;byte&gt; packet)</code><a class="headerlink" href="#protected-override-void-sendunreliablecustompeer-destination-arraysegmentbyte-packet" title="Permanent link">⚓︎</a></h4>
<p>This methods sends a packet to the server using an <strong>unreliable</strong> and <strong>unordered</strong> channel (e.g. UDP). Packets sent with this method are <em>extremely</em> latency sensitive and must arrive as soon as possible or not at all. It is expected that some packets sent using this method may be lost or arrive out of order.</p>
<h4 id="clientdisconnected"><code>ClientDisconnected</code><a class="headerlink" href="#clientdisconnected" title="Permanent link">⚓︎</a></h4>
<p>When a peer disconnects from the server you must call <code>ClientDisconnected</code> to notify the server.</p>
<h2 id="editor-inspector">Editor Inspector<a class="headerlink" href="#editor-inspector" title="Permanent link">⚓︎</a></h2>
<p>Finally you should create an inspector for your CustomCommsNetwork. Doing this is very simple, extend the <code>BaseDissonanceCommsNetworkEditor</code> class and pass the same 5 generic types you defined above. Attach the <code>CustomEditor</code> attribute to the class. </p>
<div class="highlight"><pre><span></span><code><span class="na">[CustomEditor(typeof(CustomCommsNetwork))]</span>
<span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">CustomCommsNetworkEditor</span>
<span class="w">    </span><span class="p">:</span><span class="w"> </span><span class="n">BaseDissonnanceCommsNetworkEditor</span><span class="o">&lt;</span>
<span class="w">        </span><span class="n">CustomCommsNetwork</span><span class="p">,</span>
<span class="w">        </span><span class="n">CustomServer</span><span class="p">,</span>
<span class="w">        </span><span class="n">CustomClient</span><span class="p">,</span>
<span class="w">        </span><span class="n">CustomConn</span><span class="p">,</span>
<span class="w">        </span><span class="n">CustomClientParam</span><span class="p">,</span>
<span class="w">        </span><span class="n">CustomServerParam</span>
<span class="w">    </span><span class="o">&gt;</span>
<span class="p">{</span>
<span class="p">}</span>
</code></pre></div>
<p>This will set up a basic inspector for you.</p>
<h2 id="testing">Testing<a class="headerlink" href="#testing" title="Permanent link">⚓︎</a></h2>
<p>At this point you should have a basic voice chat system functioning with your custom network. You should set up a test scene to test it. While the test scene is running check these things:</p>
<ul>
<li>Look at the inspector for your <code>CustomCommsNetwork</code> component.<ul>
<li>Once the network session is started the <code>Mode</code> should shows "Server &amp; Client", "Client" or "Server" depending on the mode this peer is running in.</li>
<li>Once the network session has connected the <code>Connection Status</code> should show "Connected"</li>
</ul>
</li>
<li>Try sending a <a href="Text-Chat.html">text chat</a> message.</li>
<li>Create a <a href="Global-Chat-Room.html">broadcast and receipt</a> trigger and speak.</li>
<li>Look at the inspector for the <code>DissonanceComms</code> component. It shows a list of client in the session, disconnect a client and make sure they disappear.</li>
</ul>
<h2 id="extensions-loopback">Extensions: Loopback<a class="headerlink" href="#extensions-loopback" title="Permanent link">⚓︎</a></h2>
<p>The Dissonance networking system create a <code>CustomClient</code> <em>and</em> a <code>CustomServer</code> on the host machine (unless running a dedicated server). The server must be able to send and receive message to this local peer the same as any other peer. This can cause complications with some network systems which do not handle this kind of "loopback" correctly. You must also be careful to make sure you can distinguish messages from other peers to the host - make sure that they don't get processed by the host client object.</p>
<p>To handle this many of the Dissonance integrations have a special check for loopback. For example in the HLAPI integration there is a <code>HlapiCommsNetwork:PreprocessPacketToClient</code> method which is given all packets sent from the server to the client, it checks if the packet is a loopback packet and if so it passes it directly to the client and HLAPI itself never has to deal with this packet.</p>
<div class="highlight"><pre><span></span><code><span class="k">internal</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="nf">PreprocessPacketToClient</span><span class="p">(</span><span class="n">ArraySegment</span><span class="o">&lt;</span><span class="kt">byte</span><span class="o">&gt;</span><span class="w"> </span><span class="n">packet</span><span class="p">,</span>
<span class="w">    </span><span class="n">HlapiConn</span><span class="w"> </span><span class="n">destination</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="c1">// No client means this can&#39;t be loopback</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Client</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="k">null</span><span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">false</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// HLAPI way to check if this is loopback.</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">NetworkManager</span><span class="p">.</span><span class="n">singleton</span><span class="p">.</span><span class="n">client</span><span class="p">.</span><span class="n">connection</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">destination</span><span class="p">.</span><span class="n">Connection</span><span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">false</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// This is loopback!</span>

<span class="w">    </span><span class="c1">// check that we have a valid local client,</span>
<span class="w">    </span><span class="c1">// in cases of startup or in-progress shutdowns</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">Client</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">null</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Don&#39;t immediately deliver the packet, add it to a queue and</span>
<span class="w">        </span><span class="c1">// deliver it next frame. This prevents the local client from</span>
<span class="w">        </span><span class="c1">// executing &quot;within&quot; the local server which can cause</span>
<span class="w">        </span><span class="c1">// confusing stack traces.</span>
<span class="w">        </span><span class="n">_loopbackQueue</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">packet</span><span class="p">.</span><span class="n">CopyTo</span><span class="p">(</span><span class="n">_loopbackBuffers</span><span class="p">.</span><span class="n">Get</span><span class="p">()));</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">true</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="extensions-peer-to-peer">Extensions: Peer To Peer<a class="headerlink" href="#extensions-peer-to-peer" title="Permanent link">⚓︎</a></h2>
<p>Currently the network integration you have built sends all packets to the server, which then relays them to other clients. If possible you <em>may</em> want to implement peer to peer voice communications. However, you should consider the bandwidth of your game before implementing peer to peer as it is not always beneficial to use it.</p>
<p>In a non P2P setup voice follows a path like:</p>
<div class="highlight"><pre><span></span><code><span class="n">Speaker</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Server</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Listener</span><span class="w"> </span><span class="err">#</span><span class="mi">1</span>
<span class="w">                  </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Listener</span><span class="w"> </span><span class="err">#</span><span class="mi">2</span>
<span class="w">                  </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Listener</span><span class="w"> </span><span class="err">#</span><span class="mi">3</span>
</code></pre></div>
<p>In this case the bandwidth used by the speaker is 1 voice stream <code>~20 kilobits/second</code>. The bandwidth used by each listener is 1 voice stream <code>~20 kilobits/second</code>. The bandwidth used by the server is <code>(Speakers + Listeners) * Bandwidth = (1 + 3) * ~20 = ~80 kilobits/second</code>. In this setup the bandwidth of each client (speaker or listener) is the minimum possible. If your game uses client devices with tight bandwidth limits this may be the best setup.</p>
<p>In a P2P setup the voice follows a different path:</p>
<div class="highlight"><pre><span></span><code><span class="n">Speaker</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Listener</span><span class="w"> </span><span class="err">#</span><span class="mi">1</span>
<span class="w">        </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Listener</span><span class="w"> </span><span class="err">#</span><span class="mi">2</span>
<span class="w">        </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Listener</span><span class="w"> </span><span class="err">#</span><span class="mi">3</span>
</code></pre></div>
<p>The bandwidth on the server has been reduced (to zero). However, the total bandwidth for the speaker client is now <code>Listeners * Bandwidth = 3 * ~20 = ~60 kilobits/second</code>.</p>
<h3 id="implementing-p2p">Implementing P2P<a class="headerlink" href="#implementing-p2p" title="Permanent link">⚓︎</a></h3>
<p>If you have decided to use peer to peer you need to modify your <code>CustomClient</code> class. Wherever you call <code>NetworkReceivePacket</code> you should modify it to capture the return value of the method call, if the value is not call <code>ReceiveHandshakeP2P</code> with it and a <code>CustomPeer</code> object for the sender of the message. For example in the Photon Unity Networking (PUN) integration the receiving code is implemented like this:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// This event is called by PUN when a packet arrives</span>
<span class="k">public</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">PacketDelivered</span><span class="p">(</span><span class="kt">byte</span><span class="w"> </span><span class="n">eventcode</span><span class="p">,</span><span class="w"> </span><span class="n">ArraySegment</span><span class="o">&lt;</span><span class="kt">byte</span><span class="o">&gt;</span><span class="w"> </span><span class="n">data</span><span class="p">,</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">senderid</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="c1">// Skip events we don&#39;t care about</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">eventcode</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">_network</span><span class="p">.</span><span class="n">EventCodeToClient</span><span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Receive the packet, capture return value</span>
<span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NetworkReceivedPacket</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// If the value is not null</span>
<span class="w">    </span><span class="c1">// pass to handshake method with the `senderid` of this packet</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">.</span><span class="n">HasValue</span><span class="p">)</span>
<span class="w">        </span><span class="n">ReceiveHandshakeP2P</span><span class="p">(</span><span class="n">id</span><span class="p">.</span><span class="n">Value</span><span class="p">,</span><span class="w"> </span><span class="n">senderid</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>You now need to implement two more methods for sending packets:</p>
<h4 id="sendreliablep2plistclientinfotpeer-destinations-arraysegmentbyte-packet"><code>SendReliableP2P(List&lt;ClientInfo&lt;TPeer?&gt;&gt; destinations, ArraySegment&lt;byte&gt; packet)</code><a class="headerlink" href="#sendreliablep2plistclientinfotpeer-destinations-arraysegmentbyte-packet" title="Permanent link">⚓︎</a></h4>
<h4 id="sendunreliablep2plistclientinfotpeer-destinations-arraysegmentbyte-packet"><code>SendUnreliableP2P(List&lt;ClientInfo&lt;TPeer?&gt;&gt; destinations, ArraySegment&lt;byte&gt; packet)</code><a class="headerlink" href="#sendunreliablep2plistclientinfotpeer-destinations-arraysegmentbyte-packet" title="Permanent link">⚓︎</a></h4>
<p>These methods send a packet to a list of destinations. You should send the packet to as many of these destinations as possible and remove them from the list. Once you are done call the base method with the remaining items in the list, they will be sent via the server as usual. For example the PUN implementation of this is:</p>
<div class="highlight"><pre><span></span><code><span class="k">private</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">SendUnreliableP2P</span><span class="p">(</span><span class="n">IList</span><span class="o">&lt;</span><span class="n">ClientInfo</span><span class="o">&lt;</span><span class="kt">int?</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">destinations</span><span class="p">,</span>
<span class="w">    </span><span class="n">ArraySegment</span><span class="o">&lt;</span><span class="kt">byte</span><span class="o">&gt;</span><span class="w"> </span><span class="n">packet</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="c1">// Build a list of destinations we know how to send to</span>
<span class="w">    </span><span class="c1">// i.e. have a non-null Connection object</span>
<span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">dests</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">();</span>
<span class="w">    </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="kt">var</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">destinations</span><span class="p">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">item</span><span class="p">.</span><span class="n">Connection</span><span class="p">.</span><span class="n">HasValue</span><span class="p">)</span>
<span class="w">            </span><span class="n">dests</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">item</span><span class="p">.</span><span class="n">Connection</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Remove all the ones we can send to from the input list</span>
<span class="w">    </span><span class="n">destinations</span><span class="p">.</span><span class="n">RemoveAll</span><span class="p">(</span><span class="n">dests</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Send the packets to the list of destinations through PUN</span>
<span class="w">    </span><span class="n">_network</span><span class="p">.</span><span class="n">Send</span><span class="p">(</span><span class="n">packet</span><span class="p">,</span><span class="w"> </span><span class="n">dests</span><span class="p">,</span><span class="w"> </span><span class="n">reliable</span><span class="p">:</span><span class="w"> </span><span class="k">false</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Call base to do server relay for all the peers we don&#39;t</span>
<span class="w">    </span><span class="c1">// know how to contact</span>
<span class="w">    </span><span class="k">base</span><span class="p">.</span><span class="n">SendUnreliableP2P</span><span class="p">(</span><span class="n">destinations</span><span class="p">,</span><span class="w"> </span><span class="n">packet</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>Because there is a fall-back mechanism you can mix P2P and non-P2P packets as necessary. For example you start by sending everything via the server, establish a p2p connection between clients and if it fails (e.g. due to firewall or NAT settings) you can simply keep on sending via relay for that specific pair of clients. Alternatively you could monitor client bandwidth and send via P2P if there is spare bandwidth - falling back to server relay if the client is close to reaching it's bandwidth limit.</p>
<p>Finally you need to start establishing p2p connections. Override the <code>OnServerAssignedSessionId</code> method, when this is called you should send a "handshake" packet to every peer you know how to contact directly. This will tell those peers that you are available for p2p communication. For example in the PUN integration this is implemented as:</p>
<div class="highlight"><pre><span></span><code><span class="k">protected</span><span class="w"> </span><span class="k">override</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="nf">OnServerAssignedSessionId</span><span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="n">session</span><span class="p">,</span><span class="w"> </span><span class="kt">ushort</span><span class="w"> </span><span class="n">id</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">base</span><span class="p">.</span><span class="n">OnServerAssignedSessionId</span><span class="p">(</span><span class="n">session</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Create the handshake packet to send</span>
<span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArraySegment</span><span class="o">&lt;</span><span class="kt">byte</span><span class="o">&gt;</span><span class="p">(</span><span class="n">WriteHandshakeP2P</span><span class="p">(</span><span class="n">session</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="p">));</span>

<span class="w">    </span><span class="c1">// Send this to everyone else in the session through PUN</span>
<span class="w">    </span><span class="n">_network</span><span class="p">.</span><span class="n">Send</span><span class="p">(</span><span class="n">packet</span><span class="p">,</span><span class="w"> </span><span class="n">_network</span><span class="p">.</span><span class="n">EventCodeToClient</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RaiseEventOptions</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Receivers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ReceiverGroup</span><span class="p">.</span><span class="n">Others</span><span class="p">,</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="k">true</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      <a href='https://placeholder-software.co.uk/dissonance/'>Placeholder Software</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/placeholdersoft" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://discord.gg/8dKpP5W" target="_blank" rel="noopener" title="discord.gg" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M492.5 69.8c-.2-.3-.4-.6-.8-.7-38.1-17.5-78.4-30-119.7-37.1-.4-.1-.8 0-1.1.1s-.6.4-.8.8c-5.5 9.9-10.5 20.2-14.9 30.6-44.6-6.8-89.9-6.8-134.4 0-4.5-10.5-9.5-20.7-15.1-30.6-.2-.3-.5-.6-.8-.8s-.7-.2-1.1-.2C162.5 39 122.2 51.5 84.1 69c-.3.1-.6.4-.8.7C7.1 183.5-13.8 294.6-3.6 404.2c0 .3.1.5.2.8s.3.4.5.6c44.4 32.9 94 58 146.8 74.2.4.1.8.1 1.1 0s.7-.4.9-.7c11.3-15.4 21.4-31.8 30-48.8.1-.2.2-.5.2-.8s0-.5-.1-.8-.2-.5-.4-.6-.4-.3-.7-.4c-15.8-6.1-31.2-13.4-45.9-21.9-.3-.2-.5-.4-.7-.6s-.3-.6-.3-.9 0-.6.2-.9.3-.5.6-.7c3.1-2.3 6.2-4.7 9.1-7.1.3-.2.6-.4.9-.4s.7 0 1 .1c96.2 43.9 200.4 43.9 295.5 0 .3-.1.7-.2 1-.2s.7.2.9.4c2.9 2.4 6 4.9 9.1 7.2.2.2.4.4.6.7s.2.6.2.9-.1.6-.3.9-.4.5-.6.6c-14.7 8.6-30 15.9-45.9 21.8-.2.1-.5.2-.7.4s-.3.4-.4.7-.1.5-.1.8.1.5.2.8c8.8 17 18.8 33.3 30 48.8.2.3.6.6.9.7s.8.1 1.1 0c52.9-16.2 102.6-41.3 147.1-74.2.2-.2.4-.4.5-.6s.2-.5.2-.8c12.3-126.8-20.5-236.9-86.9-334.5zm-302 267.7c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.4 59.2-52.8 59.2m195.4 0c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.2 59.2-52.8 59.2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/Placeholder-Software/Dissonance" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "toc.integrate"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.92b07e13.min.js"></script>
      
        <script src="../javascript/redirector.js"></script>
      
    
  </body>
</html>